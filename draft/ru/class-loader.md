# Class Loader автоматически ищет и загружает классы

Единственный метод - **autoload_dir**, что-то вроде "улучшеного" autoload, он понимает пространства имен, зависимости и может следить и перегружать изменившиеся файлы.

Например ваше приложение имеет следущую структуру:

```
/app
	/animals
		/dog.rb  =>  class Dog; end
	/zoo.rb    =>  class Zoo; end
```

Укажите ClassLoader'у директорию в которой находятся ваши файлы и он найдет и загрузит их автоматически:


``` ruby
require 'class_loader'
autoload_dir '<...>/app'

Zoo.new           # оба класса
Animals::Dog.new  # загружены автоматически
```

явно загружать классы используя :require больше не нужно:

``` ruby
# require 'animals/dog'
# require 'app'
```

Вы можете задать множество директорий с классами и включить режим **отслеживания и перезагрузки** изменений:

``` ruby
# добавьте true для отслеживания изменений
autoload_dir '<...>/lib', true
autoload_dir '<...>/another_lib'
```
**Примечание**: в файле dog.rb вместо:

``` ruby
module Animals
  class Dog
  end
end
```

мы пишем только:

``` ruby
class Dog
end
```

ClassLoader достаточно умен чтобы по структуре папок определить что Dog находится в модуле Animals и автоматически "на лету" создать его.

По умолчанию он понимает пути с **подчеркиввением** и **кэмел-кейс**. Вы также можете добавить ваш собственный транслятор пути и адаптер ресурсов (см. примеры спецификациях), например чтобы загружать классы из интернета и базы данных.

## Демо

Этот сайт его использует, так что вы в некотором смысле видете его работающим прямо сейчас ;).

## Инсталляция

```
$ gem install class_loader
```

Исходники: http://github.com/alexeypetrushin/class_loader

**Примечание:** Он работает с Ruby 1.9.x (фактически там нет какого-то кода специфичного для 1.9, но сам я не использую 1.8 а специально тестировать нет времени, если что вы можете самостояельно это сделать там код маленький и не сложный).

## Проблемы

В Ruby 1.8.x была известная проблема - автоматическая загрузка классов не была потоко-безопасной и в продакшене приходилось загружать все классы при старте приложения. ClassLoader работает с 1.9 и я не уверен есть там такая проблема или нет, но на всякий случай для загрузки всех классов сразу можно использовать такую команду:

``` ruby
ClassLoader.preload! if app_in_production?
```

Tags : Проект, Сложность